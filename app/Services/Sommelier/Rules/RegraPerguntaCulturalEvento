<?php

namespace App\Services\Sommelier\Rules;

use App\Helpers\SommelierLog;

class RegraPerguntaCulturalEvento
{
    /**
     * Detecta perguntas culturais ou tradicionais ligadas a eventos
     */
    public static function match(string $mensagem, ?string $ocasiao): bool
    {
        if (!$ocasiao) {
            return false;
        }

        $msg = mb_strtolower($mensagem, 'UTF-8');

        return (bool) preg_match(
            '/\b(que|qual|quais|o que)\b.*\b(bebida|bebidas|se bebe|costuma|geralmente|tradicional|normalmente|mais comum)\b/',
            $msg
        );
    }

    /**
     * Resposta cultural por evento
     */
    public static function responder(string $ocasiao): string
    {
        SommelierLog::info("üéì [RegraPerguntaCulturalEvento] Respondendo pergunta cultural", [
            'ocasiao' => $ocasiao
        ]);

        switch ($ocasiao) {

            // üéÜ GRANDES DATAS
            case 'reveillon':
            case 'ano novo':
                return
                    "No Ano Novo, o mais tradicional √© brindar com espumante ou champanhe üçæ, simbolizando renova√ß√£o e bons desejos. " .
                    "Durante a festa, cervejas leves s√£o muito consumidas, e vinhos brancos ou ros√©s costumam acompanhar a ceia. " .
                    "Tudo depende se o foco √© o brinde, a refei√ß√£o ou a festa.";

            case 'natal':
                return
                    "No Natal, as bebidas costumam acompanhar a ceia. Vinhos tintos s√£o comuns com carnes mais intensas, " .
                    "enquanto vinhos brancos combinam bem com aves e peixes. Espumantes tamb√©m aparecem bastante para celebrar.";

            case 'pascoa':
                return
                    "Na P√°scoa, √© comum optar por vinhos brancos, ros√©s ou tintos mais leves, especialmente para acompanhar peixes e pratos mais delicados.";

            // üéâ EVENTOS SOCIAIS
            case 'aniversario':
                return
                    "Em anivers√°rios, o consumo costuma variar bastante. Cervejas s√£o as mais comuns em festas informais, " .
                    "enquanto espumantes, vinhos e alguns destilados aparecem mais em comemora√ß√µes √† noite.";

            case 'casamento':
                return
                    "Em casamentos, o espumante √© tradicional para o brinde. Durante a recep√ß√£o, vinhos costumam acompanhar as refei√ß√µes, " .
                    "e em festas mais longas, cervejas e drinks tamb√©m s√£o bastante servidos.";

            case 'formatura':
                return
                    "Em formaturas, o espumante √© quase obrigat√≥rio no brinde. Depois disso, cervejas e destilados aparecem bastante na comemora√ß√£o.";

            // üçñ EVENTOS GASTRON√îMICOS
            case 'churrasco':
                return
                    "No churrasco, a bebida mais comum √© a cerveja, especialmente as mais leves e refrescantes. " .
                    "Vinhos tintos jovens tamb√©m podem aparecer, principalmente para quem prefere algo diferente.";

            case 'jantar':
                return
                    "Em jantares, a escolha da bebida costuma acompanhar o prato principal. " .
                    "Vinhos s√£o os mais comuns, variando entre brancos, tintos ou ros√©s conforme a refei√ß√£o.";

            // üèñÔ∏è EVENTOS SAZONAIS
            case 'verao':
            case 'ver√£o':
                return
                    "No ver√£o, as bebidas mais consumidas costumam ser cervejas leves, espumantes, vinhos brancos e ros√©s, " .
                    "sempre priorizando algo mais refrescante.";

            case 'inverno':
                return
                    "No inverno, bebidas mais encorpadas ganham espa√ßo, como vinhos tintos, destilados e bebidas que trazem sensa√ß√£o de aquecimento.";

            // üèüÔ∏è EVENTOS COLETIVOS
            case 'confraternizacao':
            case 'confraterniza√ß√£o':
                return
                    "Em confraterniza√ß√µes, o consumo costuma ser bem variado. Cervejas agradam a maioria, " .
                    "vinhos aparecem em refei√ß√µes e destilados ficam para momentos mais descontra√≠dos.";

            // üîÅ GEN√âRICO
            default:
                return
                    "Em eventos como esse, as bebidas mais comuns costumam variar entre cervejas, vinhos e espumantes, " .
                    "dependendo do hor√°rio, do perfil dos convidados e do tipo de comemora√ß√£o.";
        }
    }
}
